<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mangrove Guardian - Evisangiang20</title>

  <!-- External Libraries -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/leaflet.draw/1.0.4/leaflet.draw-src.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/leaflet.draw/1.0.4/leaflet.draw-src.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>

  <!-- Custom Styles -->
  <style>
    /* VARIABLES */
    :root{
      --mg-green:#0a5c36;
      --mg-green-light:#1a7d4e;
      --mg-green-dark:#064527;
      --panel:rgba(255,255,255,0.95);
      --muted:#51606a;
      --navbar-height: 60px; 
    }
    
    *{box-sizing:border-box; margin:0; padding:0;}
    
    html,body{height:100%; margin:0; font-family:'Segoe UI', system-ui, sans-serif; color:#15302a;}
    body{background:#f8f9fa;}
    #map{flex:1; z-index:1;}

    .topbar{
      height: var(--navbar-height);
      padding:0 20px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      background:var(--mg-green);
      color:#fff;
      position:sticky;
      top:0;
      z-index:1500;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      border-bottom: 1px solid var(--mg-green-dark);
    }
    
    .brand{
      font-weight:600;
      font-size:20px;
      display:flex;
      align-items:center;
      gap:10px;
    }
    
    .nav-right-container{display:flex; align-items:center; gap:25px;}
    .nav-menu{display:flex; gap:25px}
    .nav-menu a{
      color:#fff;
      text-decoration:none;
      font-size:14px;
      font-weight:500;
      padding:8px 0;
      transition:opacity 0.2s;
    }
    .nav-menu a:hover{opacity:0.8;}
    .lang-switch{
      font-size:13px;
      cursor:pointer;
      background:rgba(255,255,255,0.15);
      padding:6px 12px;
      border-radius:4px;
      font-weight:500;
    }

    .chat-box-container{
      position:fixed;
      bottom:20px;
      right:20px;
      z-index:1600;
      width:350px;
      background:var(--panel);
      border-radius:8px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.15);
      border:1px solid #e1e5e9;
      display:flex;
      flex-direction:column;
      max-height:500px;
    }
    
    .chat-header{
      background: var(--mg-green);
      color: #fff;
      padding: 12px 16px;
      font-weight: 600;
      cursor:pointer;
      display:flex;
      justify-content:space-between;
      align-items:center;
      border-radius:8px 8px 0 0;
    }
    
    .chat-content{
      padding: 16px;
      flex:1;
      overflow-y: auto;
      display:flex;
      flex-direction:column;
      gap:12px;
      max-height:300px;
    }
    
    .chat-input-row{
      display:flex;
      gap:8px;
      padding:12px 16px;
      border-top:1px solid #e1e5e9;
      background:#f8f9fa;
    }
    
    .chat-input-row input{
      flex:1;
      padding:10px 12px;
      border-radius:6px;
      border:1px solid #ddd;
      outline:none;
      font-size:14px;
      background:#fff;
    }
    
    .chat-input-row button{
      background:var(--mg-green);
      border:0;
      color:#fff;
      padding:10px 16px;
      border-radius:6px;
      cursor:pointer;
      font-weight:600;
      font-size:14px;
    }

    .chat-message{
      padding:10px 14px;
      border-radius:8px;
      max-width:85%;
      font-size:14px;
      line-height:1.4;
    }
    
    .chat-user{
      background:#e3f2fd;
      align-self:flex-end;
      border-bottom-right-radius:2px;
    }
    
    .chat-bot{
      background:#f5f5f5;
      align-self:flex-start;
      border-bottom-left-radius:2px;
    }

    .app{
      height:calc(100vh - var(--navbar-height));
      position:relative;
      display:flex;
    }

    .search-row-container{
      position:absolute;
      top:20px;
      left:50%;
      transform:translateX(-50%);
      z-index:1300;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:8px;
      width:90%;
      max-width:700px;
    }
    
    .search-row{
      display:flex;
      align-items:center;
      gap:8px;
      width:100%;
    }
    
    .search-box{
      display:flex;
      align-items:center;
      background:var(--panel);
      padding:8px 16px;
      border-radius:8px;
      box-shadow:0 2px 8px rgba(0,0,0,0.1);
      width:100%;
      border:1px solid #e1e5e9;
      flex:1;
    }
    
    .search-box input{
      border:0;
      outline:none;
      padding:8px;
      font-size:14px;
      background:transparent;
      flex:1;
    }
    
    .search-box button{
      background:var(--mg-green);
      border:0;
      color:#fff;
      padding:8px 16px;
      border-radius:6px;
      cursor:pointer;
      font-weight:600;
      font-size:14px;
    }
    
    .action-btn{
      background:var(--mg-green);
      color:#fff;
      border-radius:8px;
      padding:10px 16px;
      border:none;
      cursor:pointer;
      font-weight:600;
      font-size:14px;
      white-space:nowrap;
    }
    
    .mapFlipBtn{
      background:var(--mg-green);
      border:none;
      padding:10px;
      border-radius:6px;
      color:white;
      cursor:pointer;
      font-size:16px;
    }

    .stats-toggle-btn {
      background:var(--mg-green);
      border:none;
      padding:10px 14px;
      border-radius:6px;
      color:white;
      cursor:pointer;
      font-size:16px;
      display:flex;
      align-items:center;
      justify-content:center;
      box-shadow:0 2px 6px rgba(0,0,0,0.1);
      transition:all 0.3s ease;
      white-space: nowrap;
    }

    .stats-toggle-btn:hover {
      background:var(--mg-green-light);
      transform: translateY(-1px);
    }

    .vtoolbar{
      position:absolute;
      left:20px;
      top:120px;
      z-index:1300;
      display:flex;
      flex-direction:column;
      gap:8px;
      padding:8px;
      border-radius:8px;
      background:transparent;
    }
    
    .vt-btn{
      width:44px;
      height:44px;
      border-radius:6px;
      background:var(--panel);
      display:flex;
      align-items:center;
      justify-content:center;
      border:1px solid #e1e5e9;
      box-shadow:0 2px 6px rgba(0,0,0,0.08);
      cursor:pointer;
      font-size:16px;
      transition:all 0.2s;
    }
    
    .vt-btn:hover{
      background:#f8f9fa;
    }

    .right-panel{
      position:absolute;
      right:20px;
      top:20px;
      width:320px;
      z-index:1300;
      background:var(--panel);
      border-radius:8px;
      box-shadow:0 4px 20px rgba(0,0,0,0.15);
      border:1px solid #e1e5e9;
      max-height:calc(100vh - 100px);
      overflow-y:auto;
    }
    
    .panel-inner{
      padding:16px;
    }
    
    .panel-header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      margin-bottom:16px;
      padding-bottom:12px;
      border-bottom:1px solid #e1e5e9;
    }
    
    .panel-header h3{
      margin:0;
      color:var(--mg-green);
      font-size:16px;
      font-weight:600;
    }

    .switch-row{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:12px 0;
      border-bottom:1px solid #f0f0f0;
    }
    
    .switch-label{
      font-size:14px;
      color:#333;
    }
    
    .switch{
      position:relative;
      width:44px;
      height:24px;
      border-radius:12px;
      background:#ddd;
      cursor:pointer;
    }
    
    .switch .knob{
      position:absolute;
      top:2px;
      left:2px;
      width:20px;
      height:20px;
      border-radius:50%;
      background:white;
      box-shadow:0 1px 3px rgba(0,0,0,0.2);
      transition:left 0.2s;
    }
    
    .switch.on{
      background:var(--mg-green);
    }
    
    .switch.on .knob{
      left:22px;
    }

    .basemap-toggle{
      position:absolute;
      right:20px;
      top:70px;
      z-index:1350;
    }
    
    .basemap-card{
      width:250px;
      background:var(--panel);
      border-radius:8px;
      padding:12px;
      box-shadow:0 4px 20px rgba(0,0,0,0.15);
      border:1px solid #e1e5e9;
    }
    
    .basemap-card.hidden{
      display:none;
    }
    
    .basemap-item{
      padding:10px;
      border-radius:6px;
      margin-bottom:6px;
      cursor:pointer;
      font-size:14px;
      border:1px solid transparent;
    }
    
    .basemap-item:hover{
      background:#f8f9fa;
    }
    
    .basemap-item.active{
      background:#e8f5e8;
      border-color:var(--mg-green);
    }

    .scale-box{
      position:absolute;
      left:20px;
      bottom:20px;
      background:var(--panel);
      padding:8px 12px;
      border-radius:6px;
      font-size:12px;
      border:1px solid #e1e5e9;
      z-index:1300;
      box-shadow:0 2px 4px rgba(0,0,0,0.1);
    }

    .class-item{
      display:flex;
      align-items:center;
      gap:10px;
      padding:10px 0;
      border-bottom:1px solid #f0f0f0;
    }
    
    .class-color{
      width:16px;
      height:16px;
      border-radius:3px;
    }
    
    .class-label{
      flex:1;
      font-size:13px;
    }

    .file-upload{
      margin-top:16px;
      padding:12px;
      border:2px dashed #ddd;
      border-radius:6px;
      text-align:center;
      cursor:pointer;
      transition:border-color 0.2s;
    }
    
    .file-upload:hover{
      border-color:var(--mg-green);
    }
    
    .file-hint{
      font-size:12px;
      color:var(--muted);
      margin-top:8px;
      text-align:center;
    }

    .vt-btn.active-draw{
      background:var(--mg-green);
      color:#fff;
    }
    
    .vt-btn.delete-active{
      background:#dc3545;
      color:#fff;
    }

    @media (max-width:768px){
      .nav-menu{display:none}
      .search-row{flex-wrap:wrap;}
      .right-panel{width:95%; right:2.5%;}
      .chat-box-container{width:95%; right:2.5%;}
      .stats-panel{width:95%; left:2.5%;}
      .stats-toggle-btn{display:none;}
    }

    .analysis-section {
      margin: 16px 0;
      padding: 12px;
      background: #f8f9fa;
      border-radius: 6px;
    }
    
    .pulau-selector {
      margin-bottom: 12px;
    }
    
    .pulau-selector select {
      width: 100%;
      padding: 8px;
      border-radius: 4px;
      border: 1px solid #ddd;
    }
    
    .data-display {
      background: white;
      padding: 12px;
      border-radius: 4px;
      margin-top: 8px;
    }
    
    .data-item {
      display: flex;
      justify-content: space-between;
      margin-bottom: 6px;
      font-size: 13px;
    }
    
    .data-value {
      font-weight: 600;
      color: var(--mg-green);
    }

    .custom-tooltip {
      background: rgba(255, 255, 255, 0.95) !important;
      border: 1px solid #0a5c36 !important;
      border-radius: 4px !important;
      padding: 4px 8px !important;
      font-size: 12px !important;
      font-weight: 500 !important;
    }

    .legend {
      background: white;
      padding: 10px;
      border-radius: 5px;
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
    }
    
    .legend h4 {
      margin: 0 0 8px 0;
    }

    .stats-panel {
      position: absolute;
      left: 80px;
      top: 120px;
      z-index: 1300;
      background: var(--panel);
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.15);
      border: 1px solid #e1e5e9;
      width: 300px;
      max-height: 75vh;
      overflow-y: auto;
      transition: all 0.3s ease;
    }

    .stats-header {
      font-weight: 600;
      color: var(--mg-green);
      margin-bottom: 12px;
      font-size: 16px;
      border-bottom: 2px solid var(--mg-green);
      padding-bottom: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .stats-close {
      background: none;
      border: none;
      font-size: 18px;
      cursor: pointer;
      color: var(--muted);
      padding: 0;
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .stats-close:hover {
      color: var(--mg-green);
    }

    .stat-item {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
      font-size: 13px;
      padding: 6px 0;
      border-bottom: 1px solid #f0f0f0;
    }

    .stat-item:last-child {
      border-bottom: none;
    }

    .stat-value {
      font-weight: 600;
      color: var(--mg-green);
    }

    .chart-container {
      margin-top: 15px;
      height: 200px;
      position: relative;
    }

    .download-btn {
      background: var(--mg-green);
      color: white;
      border: none;
      padding: 10px 16px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      margin-top: 15px;
      width: 100%;
      transition: background 0.3s ease;
    }

    .download-btn:hover {
      background: var(--mg-green-light);
    }

    .collapsible {
      margin-top: 10px;
    }

    .collapsible-header {
      background: #f8f9fa;
      padding: 10px;
      border-radius: 6px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 600;
      font-size: 13px;
      color: var(--mg-green);
    }

    .collapsible-content {
      padding: 10px;
      background: white;
      border-radius: 0 0 6px 6px;
      margin-top: 2px;
    }

    .collapsible.hidden .collapsible-content {
      display: none;
    }

    /* Progress Bar untuk Loading */
    .progress-bar {
      width: 100%;
      height: 4px;
      background: #f0f0f0;
      border-radius: 2px;
      overflow: hidden;
      margin: 10px 0;
    }

    .progress-fill {
      height: 100%;
      background: var(--mg-green);
      transition: width 0.3s ease;
    }

    /* Filter Controls */
    .filter-controls {
      margin: 15px 0;
      padding: 12px;
      background: #f8f9fa;
      border-radius: 6px;
    }

    .filter-title {
      font-weight: 600;
      margin-bottom: 10px;
      color: var(--mg-green);
    }

    .filter-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .filter-btn {
      padding: 6px 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      background: white;
      cursor: pointer;
      font-size: 12px;
      transition: all 0.2s;
    }

    .filter-btn.active {
      background: var(--mg-green);
      color: white;
      border-color: var(--mg-green);
    }

    .filter-btn:hover {
      background: #e9ecef;
    }

    .filter-btn.active:hover {
      background: var(--mg-green-light);
    }
  </style>
</head>
<body>

  <!-- Header -->
  <div class="topbar">
    <div class="brand">
      <span>üåø MangroveGuardian - Evisangiang20</span>
    </div>
    <div class="nav-right-container">
      <div class="nav-menu" id="navMenu">
        <a href="indeks.html" data-key="home">Beranda</a>
        <a href="indeks.html" data-key="about">Tentang</a>
        <a href="indeks.html" data-key="team">Tim</a>
        <a href="indeks.html" data-key="contact">Kontak</a>
      </div>
      <div class="lang-switch" id="langSwitch">ID / EN</div>
    </div>
  </div>

  <!-- Chat Box -->
  <div class="chat-box-container" id="chatBoxContainer">
    <div class="chat-header" id="chatHeader">
      <span>üí¨ Asisten Mangrove</span>
      <span>‚àí</span>
    </div>
    <div class="chat-content" id="chatContent">
      <div class="chat-message chat-bot">Halo! Saya asisten virtual Mangrove Guardian. Data Evisangiang20 memiliki 116 poligon dengan total luasan akan dihitung otomatis.</div>
    </div>
    <div class="chat-input-row">
      <input type="text" id="chatInput" placeholder="Ketik pertanyaan Anda..." />
      <button id="sendChat">Kirim</button>
    </div>
  </div>

  <!-- Main App -->
  <div class="app">
    <div id="map"></div>

    <!-- Search Bar dengan Tombol Statistik di Kiri -->
    <div class="search-row-container">
      <div class="search-row">
        <!-- Tombol Statistik di sebelah kiri search box -->
        <button class="stats-toggle-btn" id="statsToggle" title="Toggle Panel Statistik">
          üìä Statistik
        </button>

        <!-- Search Box di tengah -->
        <div class="search-box">
          <input id="searchInput" placeholder="Cari lokasi atau koordinat (contoh: -5.969,105.859)..." />
          <button id="doSearch">Cari</button>
        </div>

        <!-- Tombol-tombol lainnya di sebelah kanan -->
        <button class="action-btn" id="addPointBtn">+ Titik Baru</button>
        <button id="basemapFlipBtn" class="mapFlipBtn" title="Peta Dasar">üó∫Ô∏è</button>
        <button id="togglePanelBtn" class="mapFlipBtn" title="Panel Layer">‚ò∞</button>
      </div>
    </div>

    <!-- Statistics Panel -->
    <div class="stats-panel" id="statsPanel">
      <div class="stats-header">
        <span>üìä Statistik Evisangiang20</span>
        <button class="stats-close" id="statsClose" title="Tutup">‚úï</button>
      </div>
      
      <div class="progress-bar">
        <div class="progress-fill" id="dataProgress" style="width: 100%"></div>
      </div>
      
      <div class="stat-item">
        <span>Total Luasan:</span>
        <span class="stat-value" id="totalLuas">Menghitung...</span>
      </div>
      <div class="stat-item">
        <span>Jumlah Poligon:</span>
        <span class="stat-value" id="jumlahPoligon">116</span>
      </div>
      <div class="stat-item">
        <span>Kerapatan Rata-rata:</span>
        <span class="stat-value" id="kerapatanRata">Menghitung...</span>
      </div>
      <div class="stat-item">
        <span>Luasan Tertinggi:</span>
        <span class="stat-value" id="luasMax">Menghitung...</span>
      </div>
      <div class="stat-item">
        <span>Luasan Terendah:</span>
        <span class="stat-value" id="luasMin">Menghitung...</span>
      </div>

      <!-- Filter Controls -->
      <div class="filter-controls">
        <div class="filter-title">Filter Kerapatan:</div>
        <div class="filter-buttons">
          <button class="filter-btn active" data-density="all">Semua</button>
          <button class="filter-btn" data-density="1">Sangat Rendah</button>
          <button class="filter-btn" data-density="2">Rendah</button>
          <button class="filter-btn" data-density="3">Sedang-Rendah</button>
          <button class="filter-btn" data-density="4">Sedang</button>
          <button class="filter-btn" data-density="5">Tinggi</button>
          <button class="filter-btn" data-density="6">Sangat Tinggi</button>
        </div>
      </div>

      <!-- Collapsible Chart Section -->
      <div class="collapsible" id="chartCollapsible">
        <div class="collapsible-header" id="chartHeader">
          <span>üìà Grafik Distribusi</span>
          <span>‚ñº</span>
        </div>
        <div class="collapsible-content">
          <div class="chart-container">
            <canvas id="densityChart"></canvas>
          </div>
        </div>
      </div>

      <!-- Collapsible Detail Section -->
      <div class="collapsible" id="detailCollapsible">
        <div class="collapsible-header" id="detailHeader">
          <span>üîç Detail Kerapatan</span>
          <span>‚ñº</span>
        </div>
        <div class="collapsible-content">
          <div class="stat-item">
            <span>Sangat Rendah (1):</span>
            <span class="stat-value" id="detailSangatRendah">Menghitung...</span>
          </div>
          <div class="stat-item">
            <span>Rendah (2):</span>
            <span class="stat-value" id="detailRendah">Menghitung...</span>
          </div>
          <div class="stat-item">
            <span>Sedang-Rendah (3):</span>
            <span class="stat-value" id="detailSedangRendah">Menghitung...</span>
          </div>
          <div class="stat-item">
            <span>Sedang (4):</span>
            <span class="stat-value" id="detailSedang">Menghitung...</span>
          </div>
          <div class="stat-item">
            <span>Tinggi (5):</span>
            <span class="stat-value" id="detailTinggi">Menghitung...</span>
          </div>
          <div class="stat-item">
            <span>Sangat Tinggi (6):</span>
            <span class="stat-value" id="detailSangatTinggi">Menghitung...</span>
          </div>
        </div>
      </div>

      <button class="download-btn" id="downloadData">
        üì• Download Data GeoJSON
      </button>

      <button class="download-btn" id="screenshot" style="background: #6c757d; margin-top: 8px;">
        üì∑ Screenshot Peta
      </button>
    </div>

    <!-- Toolbar -->
    <div class="vtoolbar">
      <div class="vt-btn" id="zoomIn" title="Zoom In">+</div>
      <div class="vt-btn" id="zoomOut" title="Zoom Out">‚àí</div>
      <div class="vt-btn" id="measureBtn" title="Ukur Jarak">üìè</div>
      <div style="border-top:1px solid #eee; margin:6px 0"></div>
      <div class="vt-btn" id="drawPt" title="Titik">‚Ä¢</div>
      <div class="vt-btn" id="drawPoly" title="Poligon">‚ñ≥</div>
      <div class="vt-btn" id="drawRect" title="Persegi">‚ñ°</div>
      <div style="border-top:1px solid #eee; margin:6px 0"></div>
      <div class="vt-btn" id="deleteBtn" title="Hapus">üóëÔ∏è</div>
      <div class="vt-btn" id="printBtn" title="Cetak">üñ®Ô∏è</div>
    </div>

    <!-- Scale -->
    <div class="scale-box" id="scaleBox">Skala: 1:100,000</div>
    <div class="scale-box" id="measureBox" style="left:120px; display:none; background:#fff3cd; color:#856404;"></div>

    <!-- Right Panel -->
    <div class="right-panel" id="rightPanel">
      <div class="panel-inner">
        <div class="panel-header">
          <h3>Layer & Pengaturan</h3>
          <button id="closePanel" class="vt-btn" style="width:auto; padding:6px 10px;">‚úï</button>
        </div>

        <!-- Analisis Vegetasi Section -->
        <div class="analysis-section">
          <div style="font-weight:600; color:var(--mg-green); margin-bottom:12px;">üìä Data Evisangiang20</div>
          
          <div class="pulau-selector">
            <label for="pulauSelect">Pilih Lokasi:</label>
            <select id="pulauSelect">
              <option value="evisangiang20" selected>Evisangiang20</option>
            </select>
          </div>

          <div class="pulau-selector">
            <label for="tahunSelect">Pilih Tahun:</label>
            <select id="tahunSelect">
              <option value="2020" selected>2020</option>
            </select>
          </div>

          <div class="data-display">
            <div class="data-item">
              <span>Vegetasi Sangat Rendah:</span>
              <span class="data-value" id="dataSangatRendah">Menghitung...</span>
            </div>
            <div class="data-item">
              <span>Vegetasi Rendah:</span>
              <span class="data-value" id="dataRendah">Menghitung...</span>
            </div>
            <div class="data-item">
              <span>Vegetasi Sedang-Rendah:</span>
              <span class="data-value" id="dataSedangRendah">Menghitung...</span>
            </div>
            <div class="data-item">
              <span>Vegetasi Sedang:</span>
              <span class="data-value" id="dataSedang">Menghitung...</span>
            </div>
            <div class="data-item">
              <span>Vegetasi Tinggi:</span>
              <span class="data-value" id="dataTinggi">Menghitung...</span>
            </div>
            <div class="data-item">
              <span>Vegetasi Sangat Tinggi:</span>
              <span class="data-value" id="dataSangatTinggi">Menghitung...</span>
            </div>
            <div class="data-item">
              <span>Kerapatan Rata-rata:</span>
              <span class="data-value" id="dataEVI">Menghitung...</span>
            </div>
          </div>
        </div>

        <div class="switch-row">
          <div class="switch-label">Layer EVI</div>
          <div class="switch on" id="rasterSwitch"><div class="knob"></div></div>
        </div>

        <div style="margin:16px 0;">
          <div style="font-weight:600; color:var(--mg-green); margin-bottom:12px;">Kelas Kerapatan EVI</div>
          <div id="classesList"></div>
        </div>

        <hr style="margin:16px 0; border:none; border-top:1px solid #e1e5e9;">

        <div style="font-weight:600; color:var(--mg-green); margin-bottom:12px;">Ekspor Data</div>
        <div class="file-upload" id="fileUploadArea">
          <div>üìÅ Upload File GeoJSON</div>
          <input type="file" id="fileInput" accept=".json,.geojson" style="display:none" />
        </div>
        <div class="file-hint">Format yang didukung: GeoJSON, JSON</div>

        <button class="download-btn" id="exportReport">
          üìÑ Export Laporan PDF
        </button>
      </div>
    </div>

    <!-- Basemap Panel -->
    <div class="basemap-toggle">
      <div class="basemap-card hidden" id="basemapCard">
        <div style="font-weight:600; margin-bottom:12px;">Peta Dasar</div>
        <div class="basemap-item active" data-basemap="osm">OpenStreetMap</div>
        <div class="basemap-item" data-basemap="satellite">Satelit</div>
        <div class="basemap-item" data-basemap="terrain">Topografi</div>
      </div>
    </div>
  </div>

  <script>
    // ==================== DATA EVISANGIANG20 LENGKAP ====================
    const evisangiang20 = {
      "type": "FeatureCollection",
      "features": [
        {
          "type": "Feature",
          "id": 1,
          "geometry": {
            "type": "MultiPolygon",
            "coordinates": [
              [[[105.85983057644216,-5.9698642862062563],[105.8600996560338,-5.9698638656230809],[105.86009923590167,-5.969594461212977],[105.85983015644143,-5.9695948817770406],[105.85983057644216,-5.9698642862062563]]],
              [[[105.85983057644216,-5.9698642862062563],[105.85929241720103,-5.969865126977929],[105.85929283695825,-5.9701345314426399],[105.85848559755775,-5.9701357916707165],[105.85848517819474,-5.9698663871487403],[105.85794701876088,-5.9698672266048156],[105.85794576157581,-5.9690590129084287],[105.8582148409082,-5.969058593303382],[105.85821442175366,-5.9687891887517024],[105.85821400261835,-5.968519784197329],[105.85848308166874,-5.9685193644988939],[105.85848266242132,-5.9682499599609518],[105.85848224319319,-5.9679805554203504],[105.85821316440553,-5.967980975080633],[105.85821358350231,-5.9682503796403106],[105.85794450456403,-5.9682507991881453],[105.85794534255263,-5.9687896083376781],[105.85767626333237,-5.9687900277921173],[105.85767668222417,-5.9690594323819326],[105.85767752006551,-5.969598241553614],[105.85713936077892,-5.9695990801822179],[105.85713977946565,-5.9698684848022303],[105.85714019817163,-5.9701378894195285],[105.85767835798383,-5.9701370507147011],[105.85821651771904,-5.9701362114836112],[105.85821693696988,-5.9704056160219858],[105.85848601694001,-5.9704051961900158],[105.85848643634154,-5.9706746007067037],[105.85875551642383,-5.9706741807240782],[105.85875509689087,-5.9704047762264727],[105.85956233662776,-5.9704035155464146],[105.85956191671985,-5.9701341111034827],[105.85983099646218,-5.9701336906327604],[105.85983057644216,-5.9698642862062563]]],
              [[[105.85848224319319,-5.9679805554203504],[105.85875132196158,-5.9679801356285509],[105.85875090262134,-5.9677107311043205],[105.85848182398431,-5.9677111508770384],[105.85848224319319,-5.9679805554203504]]],
              [[[105.85363632129433,-5.9663716598288552],[105.8536359045648,-5.9661022549271587],[105.85336682635078,-5.9661026720873283],[105.85336724294899,-5.9663720770079935],[105.85363632129433,-5.9663716598288552]]],
              [[[105.86036243368065,-5.9658223787648152],[105.86036285367386,-5.9660917831930274],[105.86063193138786,-5.9660913626144723],[105.86063235153171,-5.9663607670208849],[105.86143958495175,-5.9663595044389552],[105.86143916441397,-5.9660901000899518],[105.86090100908255,-5.966090941904441],[105.86090058882671,-5.9658215375144827],[105.86036243368065,-5.9658223787648152]]],
              [[[105.85363548785443,-5.9658328500227871],[105.85363507116321,-5.9655634451158059],[105.85336599321181,-5.9655638622380369],[105.85336640977172,-5.9658332671639878],[105.85363548785443,-5.9658328500227871]]],
              [[[105.86036243368065,-5.9658223787648152],[105.86036201370675,-5.9655529743339928],[105.86009293623606,-5.9655533947428356],[105.86009335607865,-5.965822799192777],[105.86036243368065,-5.9658223787648152]]],
              [[[105.86305320863768,-5.9658181672543673],[105.86305278735071,-5.9655487630150548],[105.86278371007337,-5.9655491847385349],[105.86278413122905,-5.965818588997025],[105.86305320863768,-5.9658181672543673]]],
              [[[105.85470971410319,-5.9644841559613173],[105.85471013124291,-5.9647535608030662],[105.85497920870458,-5.9647531430805047],[105.85497879143355,-5.9644837382577549],[105.85470971410319,-5.9644841559613173]]],
              [[[105.85470971410319,-5.9644841559613173],[105.85470929698262,-5.9642147511169927],[105.85444021976433,-5.9642151686701226],[105.85417114252687,-5.9642155860918171],[105.85363298799447,-5.9642164205409012],[105.85336391069951,-5.9642168375682907],[105.85309483338541,-5.9642172544642449],[105.85309441707169,-5.96394784950333],[105.85282533986971,-5.9639482662488925],[105.85282617225377,-5.9644870762059101],[105.85309524971831,-5.9644866594224339],[105.85309566607033,-5.9647560643780482],[105.85390289874286,-5.9647548131820685],[105.85390248199698,-5.9644854082833598],[105.85470971410319,-5.9644841559613173]]],
              [[[105.86089764757676,-5.9639357067104983],[105.8608984878373,-5.9644745155249179],[105.86036033400418,-5.9644753565839794],[105.86036075390086,-5.9647447610255044],[105.86009167682406,-5.9647451813769932],[105.86009209660875,-5.9650145858349291],[105.86036117381687,-5.9650141654643214],[105.86063025100563,-5.9650137449622616],[105.86062983095836,-5.9647443405425697],[105.8611679850154,-5.9647434991823616],[105.86116756472488,-5.9644740947982271],[105.86143664159314,-5.9644736739400965],[105.86197479527164,-5.9644728318295162],[105.86197563665972,-5.9650116404801903],[105.86224471373255,-5.9650112191894209],[105.8622455554606,-5.965550027791104],[105.86251463277667,-5.9655496063305513],[105.86251421177165,-5.9652802020501969],[105.86278328893707,-5.9652797804773519],[105.86278286782012,-5.9650103762135274],[105.86305194483487,-5.9650099545284023],[105.86305152360599,-5.9647405502810953],[105.8633206004701,-5.9647401284837036],[105.86332017912932,-5.9644707242528723],[105.86305110239648,-5.9644711460310802],[105.86305068120636,-5.9642017417784876],[105.86170529790832,-5.9642038486021045],[105.86170487739389,-5.9639344442509579],[105.86143580080751,-5.9639348652022326],[105.86116672420179,-5.9639352860220791],[105.86089764757676,-5.9639357067104983]]]
            ]
          },
          "properties": {
            "OBJECTID": 1,
            "Id": 1,
            "gridcode": 5,
            "Shape_Length": 28413.835231083445,
            "Shape_Area": 467491.35181169119,
            "luasan": 46.77622935933443
          }
        },
        {
          "type": "Feature",
          "id": 2,
          "geometry": {
            "type": "MultiPolygon",
            "coordinates": [
              [[[105.85848517819474,-5.9698663871487403],[105.85848559755775,-5.9701357916707165],[105.85929283695825,-5.9701345314426399],[105.85929241720103,-5.969865126977929],[105.85983057644216,-5.9698642862062563],[105.85983015644143,-5.9695948817770406],[105.85956107696191,-5.9695953022095498],[105.85902291794501,-5.9695961426799089],[105.85902333755153,-5.9698655471664264],[105.85848517819474,-5.9698663871487403]]],
              [[[105.85848517819474,-5.9698663871487403],[105.85848433952654,-5.969327578096788],[105.85821526008202,-5.9693279978524521],[105.8582148409082,-5.969058593303382],[105.85794576157581,-5.9690590129084287],[105.85794701876088,-5.9698672266048156],[105.85848517819474,-5.9698663871487403]]],
              [[[105.85848350093541,-5.968788769034191],[105.85848308166874,-5.9685193644988939],[105.85821400261835,-5.968519784197329],[105.85821442175366,-5.9687891887517024],[105.85848350093541,-5.968788769034191]]],
              [[[105.85875174132107,-5.9682495401500688],[105.85875132196158,-5.9679801356285509],[105.85848224319319,-5.9679805554203504],[105.85848266242132,-5.9682499599609518],[105.85875174132107,-5.9682495401500688]]],
              [[[105.86143916441397,-5.9660901000899518],[105.86143958495175,-5.9663595044389552],[105.86170866271979,-5.966359083315349],[105.86170824205067,-5.9660896789854929],[105.86143916441397,-5.9660901000899518]]],
              [[[105.86143916441397,-5.9660901000899518],[105.86143874389549,-5.9658206957382713],[105.86116966637077,-5.965821116692112],[105.86116924600293,-5.9655517123186801],[105.86063109115813,-5.9655525537936853],[105.86036201370675,-5.9655529743339928],[105.86036243368065,-5.9658223787648152],[105.86090058882671,-5.9658215375144827],[105.86090100908255,-5.966090941904441],[105.86143916441397,-5.9660901000899518]]],
              [[[105.86278371007337,-5.9655491847385349],[105.86278328893707,-5.9652797804773519],[105.86251421177165,-5.9652802020501969],[105.86251463277667,-5.9655496063305513],[105.86278371007337,-5.9655491847385349]]],
              [[[105.86063067107222,-5.965283149379295],[105.86116882565443,-5.9652823079425552],[105.8611679850154,-5.9647434991823616],[105.86062983095836,-5.9647443405425697],[105.86063025100563,-5.9650137449622616],[105.86036117381687,-5.9650141654643214],[105.86036159375215,-5.9652835699004783],[105.86063067107222,-5.965283149379295]]],
              [[[105.86197479527164,-5.9644728318295162],[105.86143664159314,-5.9644736739400965],[105.86143790291656,-5.9652818870269986],[105.86197605738279,-5.9652810448015128],[105.8619764781252,-5.9655504491201938],[105.8622455554606,-5.965550027791104],[105.86224471373255,-5.9650112191894209],[105.86197563665972,-5.9650116404801903],[105.86197479527164,-5.9644728318295162]]],
              [[[105.86251336981971,-5.9647413934815425],[105.86251294887278,-5.9644719891931768],[105.86224387208188,-5.9644724105770663],[105.86224429289753,-5.9647418148845972],[105.86251336981971,-5.9647413934815425]]],
              [[[105.86332017912932,-5.9644707242528723],[105.8633206004701,-5.9647401284837036],[105.86358967731479,-5.9647397065548668],[105.86358925584273,-5.9644703023432246],[105.86332017912932,-5.9644707242528723]]],
              [[[105.85417114252687,-5.9642155860918171],[105.85417072568805,-5.9639461812067891],[105.8539016485627,-5.963946598478068],[105.85363257141817,-5.9639470156179177],[105.85363298799447,-5.9642164205409012],[105.85417114252687,-5.9642155860918171]]],
              [[[105.86332017912932,-5.9644707242528723],[105.8633197578079,-5.9642013200194635],[105.86331933650585,-5.9639319157833297],[105.86170487739389,-5.9639344442509579],[105.86170529790832,-5.9642038486021045],[105.86305068120636,-5.9642017417784876],[105.86305110239648,-5.9644711460310802],[105.86332017912932,-5.9644707242528723]]],
              [[[105.86089722747548,-5.9636663022993179],[105.86089764757676,-5.9639357067104983],[105.86116672420179,-5.9639352860220791],[105.86116630396924,-5.9636658816300354],[105.86089722747548,-5.9636663022993179]]],
              [[[105.857130154537,-5.9636721778699586],[105.85712973629266,-5.9634027731888111],[105.85686065964103,-5.9634031918677142],[105.85686107775412,-5.9636725965679078],[105.857130154537,-5.9636721778699586]]],
              [[[105.85766830804512,-5.9636713400797916],[105.85766788953826,-5.9634019354367549],[105.85739881292508,-5.9634023543784913],[105.85739923130069,-5.9636717590405866],[105.85766830804512,-5.9636713400797916]]],
              [[[105.85928276810738,-5.9636688235551549],[105.85928234881295,-5.963399419026592],[105.85874419579847,-5.9634002583556445],[105.85874461483037,-5.9636696629223893],[105.85901369147851,-5.9636692433044827],[105.85901411066094,-5.9639386478494467],[105.85928318742107,-5.963938228081024],[105.85928276810738,-5.9636688235551549]]],
              [[[105.85605342957071,-5.9634044471159244],[105.85605301187061,-5.9631350423559857],[105.85578393527334,-5.9631354604902009],[105.85578435284218,-5.9634048652691609],[105.85605342957071,-5.9634044471159244]]],
              [[[105.85470762869224,-5.9631371317129496],[105.85470721166759,-5.9628677268553014],[105.85416905852442,-5.9628685616402306],[105.85416947528658,-5.9631379665358573],[105.85470762869224,-5.9631371317129496]]],
              [[[105.85793654751335,-5.9631321117369867],[105.85793612891372,-5.962862707107714],[105.85766705258229,-5.9628631261427394],[105.85766747105065,-5.9631325307910759],[105.85793654751335,-5.9631321117369867]]],
              [[[105.85982008221269,-5.9631291746788762],[105.85981966269435,-5.9628597701832193],[105.8595505864978,-5.9628601901380742],[105.8595510058849,-5.9631295946528367],[105.85982008221269,-5.9631291746788762]]],
              [[[105.86089722747548,-5.9636663022993179],[105.86089680739352,-5.9633968978854455],[105.86116588375602,-5.9633964772352979],[105.8614349600992,-5.9633960564537354],[105.86143453977405,-5.9631266520754984],[105.8619726921399,-5.9631258101564271],[105.86197227157159,-5.9628564058138336],[105.86143411946823,-5.9628572476946031],[105.86116504338753,-5.9628576684378833],[105.8611654635621,-5.9631270728379198],[105.85982008221269,-5.9631291746788762],[105.85982092130727,-5.9636679836622308],[105.86035907442999,-5.9636671432436179],[105.86035865461054,-5.9633977387914916],[105.86062773101168,-5.9633973184041764],[105.86062815096238,-5.9636667228371794],[105.86089722747548,-5.9636663022993179]]],
              [[[105.86251084442841,-5.9631249677117157],[105.86251042359758,-5.962855563407448],[105.86224134759425,-5.9628559846763434],[105.86224176829381,-5.9631253889997762],[105.86251084442841,-5.9631249677117157]]],
              [[[105.85605259418972,-5.9628656375933904],[105.85632167063655,-5.962865219346793],[105.85632125284363,-5.962595814600534],[105.85578310019325,-5.9625966509242714],[105.85578351772369,-5.9628660557085817],[105.85605259418972,-5.9628656375933904]]],
              [[[105.85712848167503,-5.9625945591294354],[105.85659032913999,-5.9625953962415661],[105.85659074706415,-5.9628648009687923],[105.85685982347255,-5.9628643824593857],[105.85686024154717,-5.9631337871648791],[105.85712931806754,-5.9631333685050221],[105.85712848167503,-5.9625945591294354]]],
              [[[105.8595505864978,-5.9628601901380742],[105.85955016713,-5.9625907856206197],[105.85901201494154,-5.9625916250979234],[105.85901243404686,-5.9628610296535713],[105.8595505864978,-5.9628601901380742]]],
              [[[105.86304857554617,-5.9628547204754492],[105.86304815447224,-5.9625853162068374],[105.86277907863885,-5.9625857377193618],[105.86277949958155,-5.9628551420071503],[105.86304857554617,-5.9628547204754492]]],
              [[[105.85766621570328,-5.9623243168380746],[105.85766663413315,-5.96259372149171],[105.85793571033335,-5.9625933024757503],[105.85793529177224,-5.9623238978411779],[105.85766621570328,-5.9623243168380746]]],
              [[[105.85766621570328,-5.9623243168380746],[105.85766579729264,-5.9620549121817472],[105.85739672133566,-5.9620553310281936],[105.85712764535944,-5.9620557497432527],[105.85712806350762,-5.9623251544376901],[105.85739713961507,-5.9623247357035787],[105.85766621570328,-5.9623243168380746]]],
              [[[105.85901201494154,-5.9625916250979234],[105.8590111767887,-5.9620528159787201],[105.85874210092804,-5.9620532354820988],[105.85874293881839,-5.9625920446394778],[105.85901201494154,-5.9625916250979234]]],
              [[[105.86170235471344,-5.9623180180884345],[105.86170193433439,-5.9620486137186965],[105.86170151397468,-5.9617792093463171],[105.86116336288246,-5.9617800508111216],[105.86116378297974,-5.9620494552217895],[105.86089470727343,-5.9620498757762572],[105.86089512725881,-5.9623192802034213],[105.86170235471344,-5.9623180180884345]]],
              [[[105.85874168201175,-5.9617838308994235],[105.85874126311477,-5.9615144263140722],[105.85847218749723,-5.9615148456479004],[105.85847260626302,-5.9617842502523333],[105.85874168201175,-5.9617838308994235]]],
              [[[105.8592798334514,-5.9617829917994634],[105.85928025263011,-5.9620523963439567],[105.85981840425508,-5.9620515566802688],[105.85981756539204,-5.9615127476650169],[105.85954848985163,-5.9615131675243429],[105.85954890914229,-5.961782572052412],[105.8592798334514,-5.9617829917994634]]],
              [[[105.86062521171299,-5.9617808917504052],[105.86062479189746,-5.9615114872987958],[105.86035571641494,-5.9615119075522438],[105.86035613609927,-5.9617813120229766],[105.86062521171299,-5.9617808917504052]]],
              [[[105.85766454217622,-5.9612466981968204],[105.85766496052912,-5.961516102861137],[105.85793403620441,-5.9615156839214327],[105.85793361772031,-5.96124627927618],[105.85766454217622,-5.9612466981968204]]],
              [[[105.8592798334514,-5.9617829917994634],[105.85927941429195,-5.961513587252294],[105.8592789951518,-5.9612441827024512],[105.85900991970404,-5.9612446022799332],[105.8590107577412,-5.9617834114151336],[105.8592798334514,-5.9617829917994634]]],
              [[[105.85766454217622,-5.9612466981968204],[105.85766412384257,-5.9609772935298979],[105.85739504841045,-5.9609777123001111],[105.8573954666129,-5.9612471169860921],[105.85766454217622,-5.9612466981968204]]],
              [[[105.85954765132819,-5.9609743584602501],[105.85954807058027,-5.9612437629935995],[105.85981714598945,-5.96124334315338],[105.85981672660617,-5.9609739386391372],[105.85954765132819,-5.9609743584602501]]],
              [[[105.85954765132819,-5.9609743584602501],[105.85954723209538,-5.9607049539242096],[105.85900908174396,-5.9607057931341565],[105.85900950071436,-5.9609751977083905],[105.85927857603092,-5.9609747781500015],[105.85954765132819,-5.9609743584602501]]],
              [[[105.85524161001335,-5.9604422480482757],[105.85497253467067,-5.9604426655982143],[105.85497295165389,-5.9607120704607803],[105.85524202712776,-5.9607116528918365],[105.85524161001335,-5.9604422480482757]]],
              [[[105.85524161001335,-5.9604422480482757],[105.8557797606411,-5.9604414125543439],[105.85577934328349,-5.9601720077461522],[105.85551026811041,-5.9601724255397777],[105.8552411929181,-5.9601728432020584],[105.85524161001335,-5.9604422480482757]]],
              [[[105.86035487710426,-5.960973098602822],[105.86035361828301,-5.9601648851587692],[105.86008454343718,-5.9601653051852548],[105.86008580186487,-5.9609735186866608],[105.86035487710426,-5.960973098602822]]],
              [[[105.85766412384257,-5.9609772935298979],[105.85793319925546,-5.9609768746283214],[105.85793236238351,-5.9604380653245803],[105.85873958771941,-5.9604368079461318],[105.85873916891876,-5.9601674033475129],[105.85847009395724,-5.9601678225859311],[105.85846967530703,-5.9598984179655217],[105.85766245070043,-5.9598996748354995],[105.85766412384257,-5.9609772935298979]]],
              [[[105.85954639368768,-5.9601661448441909],[105.85954597451274,-5.9598967403001453],[105.85927689974022,-5.9598971599134964],[105.85927731878398,-5.9601665644766424],[105.85954639368768,-5.9601661448441909]]],
              [[[105.85846967530703,-5.9598984179655217],[105.85873875013738,-5.9598979987461851],[105.85873833137525,-5.959628594142286],[105.85846925667609,-5.95962901334254],[105.85846967530703,-5.9598984179655217]]],
              [[[105.85712430086647,-5.9599005120921236],[105.85712346493555,-5.9593617026527985],[105.8568543902521,-5.9593621210460102],[105.85685480807676,-5.9596315257860812],[105.85631665838976,-5.9596323622165981],[105.85631707597129,-5.9599017669920187],[105.85712430086647,-5.9599005120921236]]],
              [[[105.85846925667609,-5.95962901334254],[105.85846883806441,-5.9593596087168352],[105.85819976347713,-5.9593600277666816],[105.85820018195764,-5.9596294324114627],[105.85846925667609,-5.95962901334254]]],
              [[[105.86008244644374,-5.9588182826297498],[105.86008202710295,-5.9585488781106895],[105.86035110116178,-5.9585484581989103],[105.86035026227582,-5.9580096491910064],[105.86008118847927,-5.9580100690645494],[105.85981211466343,-5.9580104888067966],[105.85981337223447,-5.9588187024293315],[105.86008244644374,-5.9588182826297498]]],
              [[[105.8590036368829,-5.9572035334274904],[105.85873456338332,-5.957203952587288],[105.85873498197202,-5.9574733572151093],[105.85846590832202,-5.9574737762627095],[105.85846632679886,-5.9577431809070074],[105.85873540057997,-5.9577427618403256],[105.8587358192072,-5.9580121664628187],[105.85900489310018,-5.9580117472457585],[105.8590036368829,-5.9572035334274904]]],
              [[[105.8590036368829,-5.9572035334274904],[105.85927271036323,-5.9572031141364139],[105.85927229153158,-5.9569337095440842],[105.85900321818237,-5.9569341288160667],[105.8590036368829,-5.9572035334274904]]],
              [[[105.85819641632631,-5.9572047905130461],[105.85846548986446,-5.9572043716158065],[105.8584646530071,-5.9566655623139821],[105.8581955797312,-5.9566659811730709],[105.85792650643602,-5.9566663999008922],[105.85792734276895,-5.9572052092790067],[105.85765826919229,-5.9572056279136882],[105.85765868725649,-5.9574750326178014],[105.85792776096426,-5.9574746139640551],[105.85792817917884,-5.9577440186464994],[105.85765910533995,-5.9577444373193087],[105.85765994156459,-5.9582832467143056],[105.85792901566577,-5.9582828280033677],[105.85792859741269,-5.9580134233262196],[105.85819767136344,-5.9580130045030497],[105.85819725299847,-5.9577435998423995],[105.85819641632631,-5.9572047905130461]]],
              [[[105.86088589204302,-5.95639238219223],[105.86088463341981,-5.955584168727472],[105.86061556084186,-5.9555845886914431],[105.86061639964251,-5.9561233977088337],[105.86007825390431,-5.9561242373195293],[105.8600786730714,-5.9563936418625261],[105.86088589204302,-5.95639238219223]]],
              [[[105.86007699651883,-5.9553160236746621],[105.86007741562801,-5.9555854282256568],[105.8603464882446,-5.9555850085241708],[105.86034606900434,-5.9553156039922932],[105.86007699651883,-5.9553160236746621]]],
              [[[105.86007699651883,-5.9553160236746621],[105.86007657742893,-5.9550466191211306],[105.8598075050552,-5.9550470386531513],[105.85980792401404,-5.9553164432257937],[105.86007699651883,-5.9553160236746621]]],
              [[[105.85927145392611,-5.9563949003514765],[105.85926894157249,-5.9547784727099122],[105.85899986927198,-5.9547788918291458],[105.85900238083913,-5.9563953195852717],[105.85927145392611,-5.9563949003514765]]],
              [[[105.8598075050552,-5.9550470386531513],[105.85980708611567,-5.9547776340777689],[105.85953801385372,-5.954778053459453],[105.85953843266219,-5.9550474580539401],[105.8598075050552,-5.9550470386531513]]],
              [[[105.86007657742893,-5.9550466191211306],[105.86034564978335,-5.9550461994578807],[105.86061472211848,-5.955045779663398],[105.86061430278572,-5.9547763751453688],[105.86007615835832,-5.9547772145648601],[105.86007657742893,-5.9550466191211306]]],
              [[[105.85684478559141,-5.9531658112920871],[105.85684436822818,-5.9528964064882972],[105.85657529667168,-5.9528968242932274],[105.85657571390389,-5.9531662291160572],[105.85684478559141,-5.9531658112920871]]],
              [[[105.84688829538835,-5.9526423723952817],[105.84661922325577,-5.9526427853275736],[105.84661963562107,-5.9529121908532678],[105.84688870788467,-5.9529117779021572],[105.84688829538835,-5.9526423723952817]]],
              [[[105.84688829538835,-5.9526423723952817],[105.84715736750196,-5.9526419593318112],[105.84715695489363,-5.952372553841073],[105.84688788291106,-5.9523729668857195],[105.84688829538835,-5.9526423723952817]]],
              [[[105.8474256141369,-5.9521027351907101],[105.84742602685721,-5.9523721406652541],[105.84769509880174,-5.9523717273582601],[105.84769468595042,-5.9521023219025535],[105.8474256141369,-5.9521027351907101]]],
              [[[105.8474256141369,-5.9521027351907101],[105.8474252014356,-5.9518333297134971],[105.84715612973405,-5.9518337428516555],[105.84715654230433,-5.9521031483476996],[105.8474256141369,-5.9521027351907101]]],
              [[[105.8474252014356,-5.9518333297134971],[105.84769427311812,-5.9518329164441761],[105.84769386030484,-5.9515635109831315],[105.84742478875332,-5.951563924233616],[105.8474252014356,-5.9518333297134971]]],
              [[[105.84688623319188,-5.9512953448209789],[105.84688664559317,-5.9515647503411184],[105.84715571718276,-5.9515643373529441],[105.84715530465047,-5.9512949318516295],[105.84688623319188,-5.9512953448209789]]],
              [[[105.84715530465047,-5.9512949318516295],[105.84742437609005,-5.9512945187511308],[105.84769344751058,-5.9512941055194828],[105.84796251891211,-5.9512936921566855],[105.84796210600589,-5.9510242867091945],[105.84742396344579,-5.9510251132659615],[105.8471548921372,-5.9510255263476308],[105.84715530465047,-5.9512949318516295]]],
              [[[105.85092188872487,-5.951019731270252],[105.85065281766394,-5.9510201460567789],[105.85065323188,-5.9512895513155195],[105.8509223030719,-5.9512891365100842],[105.85092188872487,-5.951019731270252]]],
              [[[105.84688623319188,-5.9512953448209789],[105.84688582080959,-5.9510259392981562],[105.84688540844631,-5.9507565337726955],[105.84661633723069,-5.9507569465732599],[105.846616749463,-5.9510263521175375],[105.84661716171429,-5.9512957576591798],[105.84688623319188,-5.9512953448209789]]],
              [[[105.85092188872487,-5.951019731270252],[105.85146003078944,-5.9510189013037698],[105.85145961619956,-5.9507494960991343],[105.85092147439693,-5.9507503260277828],[105.85092188872487,-5.951019731270252]]],
              [[[105.84634602980601,-5.9499491425374886],[105.84580788806559,-5.9499499673701104],[105.84580829984804,-5.9502193729787791],[105.84607737085871,-5.9502189606092282],[105.84607819474246,-5.9507577717809754],[105.84634726599607,-5.9507573592426866],[105.84634602980601,-5.9499491425374886]]],
              [[[105.83477515295704,-5.9494279480998227],[105.83477555933264,-5.9496973544794205],[105.83504463085453,-5.9496969475231642],[105.83504503737981,-5.9499663538816083],[105.83531410901395,-5.9499659467756763],[105.83531370235769,-5.9496965404357924],[105.8353132957202,-5.9494271340933116],[105.83477515295704,-5.9494279480998227]]],
              [[[105.83612091675472,-5.9496953183869863],[105.83612050972438,-5.9494259121002235],[105.83558236707367,-5.9494267268933907],[105.83558277384212,-5.9496961332173068],[105.83612091675472,-5.9496953183869863]]],
              [[[105.83531248250142,-5.9488883214003438],[105.83531288910143,-5.9491577277481431],[105.83558196032396,-5.9491573205667905],[105.83558155359302,-5.9488879142375577],[105.83531248250142,-5.9488883214003438]]],
              [[[105.83881081353023,-5.9491524241645095],[105.83881040522805,-5.9488830180585479],[105.83854133436181,-5.9488834267944988],[105.83854174253308,-5.9491528329190997],[105.83881081353023,-5.9491524241645095]]],
              [[[105.84123245165688,-5.9491487394735785],[105.84177059325533,-5.949147919211244],[105.84176977378924,-5.948609107407508],[105.84150070326132,-5.9486095175668181],[105.84150111285399,-5.9488789234887163],[105.84123204217627,-5.9488793335356345],[105.84123245165688,-5.9491487394735785]]],
              [[[105.83531248250142,-5.9488883214003438],[105.83531207592016,-5.9486189150498907],[105.83531166935762,-5.9483495086967402],[105.83450445675597,-5.9483507292871813],[105.83450486292573,-5.9486201356959985],[105.83396672083582,-5.9486209488046118],[105.83396753270776,-5.949159761688354],[105.83423660402394,-5.9491593551625188],[105.83423701011894,-5.9494287615818955],[105.83477515295704,-5.9494279480998227],[105.83477434026203,-5.9488891353326219],[105.83531248250142,-5.9488883214003438]]],
              [[[105.84042442096089,-5.9486111568931523],[105.8404240119108,-5.9483417508937952],[105.83988587090926,-5.9483425697330752],[105.83961680038024,-5.9483429789560889],[105.83961720903757,-5.9486123850114501],[105.83907906766112,-5.9486132031015293],[105.83907947607543,-5.9488826091915001],[105.83934854690399,-5.9488822001933546],[105.83934895546807,-5.9491516062620207],[105.83988709733055,-5.949150787835122],[105.83988750617533,-5.9494201938638369],[105.83961843512259,-5.9494206031615011],[105.83961925260679,-5.9499594152482853],[105.83988832392144,-5.9499590059132954],[105.83988791503897,-5.949689599889866],[105.84069512847702,-5.9496883711541999],[105.84069553775237,-5.9499577771216057],[105.841233680212,-5.9499569572715423],[105.84123245165688,-5.9491487394735785],[105.84096338082935,-5.9491491494080924],[105.84096297147966,-5.9488797434514558],[105.84096256214885,-5.9486103374921653],[105.84042442096089,-5.9486111568931523],[105.84042523911765,-5.9491499688838116],[105.84042564822433,-5.949419374875184],[105.84015657720926,-5.9494197844350651],[105.84015616823353,-5.9491503784250179],[105.84015535033863,-5.9486115663970081],[105.84042442096089,-5.9486111568931523]]],
              [[[105.84284564548354,-5.9483380596283517],[105.84311471578604,-5.9483376488323252],[105.84311430544562,-5.9480682430174765],[105.84257616508357,-5.9480690644409835],[105.84257657516216,-5.9483384702932947],[105.84284564548354,-5.9483380596283517]]],
              [[[105.84715035574578,-5.9480620656287382],[105.8468812858586,-5.9480624783721989],[105.84688211022413,-5.948601289473511],[105.8466130400561,-5.94860170212353],[105.84661345213644,-5.9488711076890199],[105.84742066297629,-5.948869869289223],[105.84742025050316,-5.9486004637802044],[105.84715118037315,-5.9486008766924021],[105.84715035574578,-5.9480620656287382]]],
              [[[105.84822622229554,-5.9477910078836613],[105.84822663510434,-5.9480604133441233],[105.84849570489642,-5.9480599999452757],[105.8484952919567,-5.947790594503668],[105.84822622229554,-5.9477910078836613]]],
              [[[105.84822622229554,-5.9477910078836613],[105.84822580950575,-5.9475216024205677],[105.84795673995646,-5.947522015650641],[105.84795715261534,-5.9477914211325835],[105.84822622229554,-5.9477910078836613]]],
              [[[105.85145505697167,-5.9477860386730459],[105.85091691804975,-5.947786868185525],[105.85091650395091,-5.9475174629112395],[105.8495711569666,-5.9475195343042175],[105.84957198387427,-5.9480583450391142],[105.84930291415837,-5.9480587589622704],[105.84876477466945,-5.9480595864153516],[105.84876518775913,-5.9483289918353979],[105.8495723973567,-5.9483277504025454],[105.84957281085818,-5.9485971557634079],[105.84984188081684,-5.9485967416714072],[105.84984229446833,-5.9488661470106861],[105.84957322437874,-5.9488665611215712],[105.84957363791835,-5.9491359664770798],[105.85011177834033,-5.9491351380864419],[105.85011260600054,-5.9496739487139614],[105.84957446505477,-5.9496747771801477],[105.84957487865158,-5.9499441825277373],[105.84984394926495,-5.949943768341317],[105.84984436301177,-5.9502131736673549],[105.85011343373704,-5.9502127593309257],[105.85011426154982,-5.9507515699372302],[105.85065240346698,-5.9507507407954012],[105.85065198928912,-5.9504813355313724],[105.85065116099061,-5.9499425249953424],[105.85172744302426,-5.9499408653650487],[105.85172702837983,-5.9496714601686982],[105.85145795803102,-5.9496718752540234],[105.85145754353665,-5.9494024700361461],[105.8514571290614,-5.949133064815582],[105.85118805895537,-5.9491334797319553],[105.85091898883024,-5.9491338945172281],[105.85091857463597,-5.9488644892561986],[105.85064950462268,-5.9488649038914625],[105.85064909057841,-5.9485954986088707],[105.85038002067697,-5.948595913094139],[105.85037960678271,-5.948326507789945],[105.85064867655323,-5.9483260933235798],[105.85064909057841,-5.9485954986088707],[105.85091816046078,-5.9485950839925152],[105.85091857463597,-5.9488644892561986],[105.85118764463014,-5.9488640744898396],[105.85118723032403,-5.9485946692450691],[105.85145630016819,-5.9485942543665349],[105.85145588575024,-5.9483248491379843],[105.85172495544438,-5.9483244341472865],[105.85172454091462,-5.9480550289350944],[105.8514554713514,-5.948055443906866],[105.85145505697167,-5.9477860386730459]]],
              [[[105.84203720506908,-5.947531073552641],[105.842036795309,-5.9472616676548888],[105.84176772545452,-5.9472620778517369],[105.84176813508368,-5.9475314837681985],[105.84203720506908,-5.947531073552641]]],
              [[[105.84392028376092,-5.9472587926072658],[105.84365121403884,-5.9472592037215355],[105.8436516245843,-5.9475286095068993],[105.84392069443729,-5.9475281983738775],[105.84392028376092,-5.9472587926072658]]],
              [[[105.85279957393085,-5.9472451523119103],[105.85253050483684,-5.94724556775114],[105.85253091970195,-5.947514972914524],[105.85226185045788,-5.9475153882416372],[105.85226226521124,-5.9477847934212962],[105.8525313345862,-5.9477843780752373],[105.85253174948957,-5.9480537832333198],[105.85226267998372,-5.9480541985983209],[105.85226309477528,-5.9483236037726446],[105.85226392441584,-5.9488624141134556],[105.8519948544981,-5.9488628294041934],[105.8519944397992,-5.9485934242162006],[105.85172536999325,-5.9485938393569118],[105.85172619914832,-5.9491326497681074],[105.85172661375452,-5.9494020549697462],[105.85226475413288,-5.9494012244436263],[105.85226433926479,-5.9491318192798577],[105.85253340929437,-5.9491314038390808],[105.85253299431447,-5.9488619986916227],[105.85253257935371,-5.9485925935415116],[105.85280164910229,-5.9485921780075346],[105.85280206419398,-5.9488615831386955],[105.85334020389558,-5.9488607516395584],[105.85333978854203,-5.9485913465463138],[105.85360885823319,-5.948590930619071],[105.85360844276786,-5.9483215255420934],[105.85387751230894,-5.9483211095027348],[105.85387709673186,-5.9480517044421637],[105.85360802732168,-5.9480521204625481],[105.8536076118947,-5.9477827153803],[105.85360719648681,-5.9475133102954194],[105.8533381273193,-5.9475137261467923],[105.85333854259626,-5.94778313125064],[105.85306947327871,-5.9477835469899105],[105.85306905813266,-5.9475141418671011],[105.85279998892685,-5.9475145574563442],[105.85279957393085,-5.9472451523119103]]],
              [[[105.84392028376092,-5.9472587926072658],[105.84418935346409,-5.9472583813619355],[105.84418894267576,-5.9469889756114158],[105.8439198731035,-5.9469893868379877],[105.84392028376092,-5.9472587926072658]]],
              [[[105.83557870700129,-5.947002069858633],[105.83584777715775,-5.9470016626947597],[105.8358473704459,-5.9467322563629166],[105.83530923037601,-5.9467330705224661],[105.83530963682608,-5.9470024768914502],[105.83504056663213,-5.9470028837932105],[105.83504016031294,-5.946733477405667],[105.83477109023117,-5.9467338841578181],[105.8347719026265,-5.947272696967417],[105.83504097297006,-5.947272290178157],[105.83504178570212,-5.9478111029400473],[105.83531085628877,-5.9478106959826036],[105.83531126281383,-5.9480801023410219],[105.83558033351264,-5.948079695233937],[105.83557992685668,-5.9478102888940851],[105.83557952021947,-5.9475408825516016],[105.83557870700129,-5.947002069858633]]],
              [[[105.83880754763968,-5.9469971752425117],[105.83880713948804,-5.9467277691153635],[105.8385380696691,-5.9467281777022052],[105.83853847768984,-5.9469975838479909],[105.83880754763968,-5.9469971752425117]]],
              [[[105.83934527906945,-5.9467269515485333],[105.83907620928818,-5.9467273603974729],[105.83907661757067,-5.9469967665059764],[105.83934568748285,-5.9469963576383851],[105.83934527906945,-5.9467269515485333]]],
              [[[105.84687963735558,-5.9469848561377319],[105.84687922527733,-5.9467154505725226],[105.84661015602565,-5.946715863090815],[105.846610567973,-5.9469852686748421],[105.84687963735558,-5.9469848561377319]]],
              [[[105.84795550209398,-5.9467137991888759],[105.84768643291834,-5.9467142122313597],[105.84768725787919,-5.9472530232461978],[105.84795632731661,-5.9472526101660312],[105.84795550209398,-5.9467137991888759]]],
              [[[105.83934527906945,-5.9467269515485333],[105.8396143488319,-5.9467265425685447],[105.83961394030646,-5.946457136494665],[105.83934487067488,-5.9464575454559965],[105.83934527906945,-5.9467269515485333]]],
              [[[105.84069021864428,-5.9464554993389083],[105.84069062769328,-5.9467249053381019],[105.84095969736148,-5.9467244957028695],[105.84095928818162,-5.9464550897223614],[105.84069021864428,-5.9464554993389083]]],
              [[[105.85010805481366,-5.9467104901313075],[105.85010764118385,-5.9464410847896954],[105.84983857229146,-5.9464414988616667],[105.8498389857904,-5.9467109042221686],[105.85010805481366,-5.9467104901313075]]],
              [[[105.85145505697167,-5.9477860386730459],[105.85172412640397,-5.9477856237202005],[105.8519931958172,-5.947785208636283],[105.85199278119472,-5.947515803437688],[105.85172371191243,-5.9475162185026722],[105.85172288298669,-5.9469774080596132],[105.8517220541374,-5.9464385976060017],[105.85145298535954,-5.9464390124642197],[105.85145505697167,-5.9477860386730459]]],
              [[[105.83907580102446,-5.9464579542862861],[105.83907539277961,-5.9461885481724677],[105.83880632324126,-5.946188956853069],[105.83880673135523,-5.9464583629855321],[105.83907580102446,-5.9464579542862861]]],
              [[[105.84069021864428,-5.9464554993389083],[105.84068980961418,-5.9461860933370829],[105.8401516707447,-5.9461869121396917],[105.84015207951308,-5.9464563181788721],[105.84069021864428,-5.9464554993389083]]],
              [[[105.84633985141947,-5.9459080586535746],[105.84634026317897,-5.9461774642643812],[105.8466093321879,-5.9461770519147601],[105.84660892029753,-5.9459076463227651],[105.84633985141947,-5.9459080586535746]]],
              [[[105.84633985141947,-5.9459080586535746],[105.84633943967896,-5.9456386530401195],[105.84607037091277,-5.9456390652210933],[105.84607078252243,-5.9459084708533538],[105.84633985141947,-5.9459080586535746]]],
              [[[105.84795550209398,-5.9467137991888759],[105.8482245712506,-5.9467133860153458],[105.84822415853695,-5.9464439805416314],[105.84822374584232,-5.9461745750652861],[105.84795467694747,-5.9461749882011201],[105.84795426440274,-5.9459055827032756],[105.84768519561973,-5.9459059956892322],[105.84768478322491,-5.9456365901698964],[105.84741571455375,-5.9456370030059889],[105.84741612681771,-5.9459064085441602],[105.84687798915658,-5.9459072338609271],[105.84687840117786,-5.9461766394341034],[105.84768560803359,-5.9461754012059203],[105.84768602046645,-5.9464448067199553],[105.84795508951122,-5.9464443936963143],[105.84795550209398,-5.9467137991888759]]],
              [[[105.84607037091277,-5.9456390652210933],[105.84606995932212,-5.9453696595861647],[105.84580089066777,-5.9453700716173135],[105.8458013021276,-5.9456394772710421],[105.84607037091277,-5.9456390652210933]]],
              [[[105.85118143204365,-5.9448229955398553],[105.85037422789368,-5.944824238594804],[105.85037505520519,-5.9453630492693685],[105.85091319184765,-5.9453622206214565],[105.85091360579374,-5.9456316259169641],[105.85118267421718,-5.9456312113775684],[105.85118226014025,-5.9453618061009754],[105.85145132841373,-5.9453613914494765],[105.85145091422504,-5.9450919861891345],[105.8511818460824,-5.9450924008217143],[105.85118143204365,-5.9448229955398553]]],
              [[[105.84768313383579,-5.944558968066004],[105.84768437084909,-5.9453671846478935],[105.84795343937039,-5.9453667716996197],[105.84795302688275,-5.9450973661937914],[105.84795220196455,-5.9445585551742548],[105.84768313383579,-5.944558968066004]]],
              [[[105.84929836854947,-5.9450952995814585],[105.84929754232286,-5.9445564887505196],[105.8490284742893,-5.9445569022972649],[105.84902888726225,-5.9448263077329484],[105.84902930025424,-5.9450957131659479],[105.84929836854947,-5.9450952995814585]]],
              [[[105.84902764840058,-5.9440180914179859],[105.8490280613354,-5.9442874968589496],[105.84929712923814,-5.9442870833310764],[105.84929671617246,-5.9440176779089828],[105.84902764840058,-5.9440180914179859]]],
              [[[105.84902764840058,-5.9440180914179859],[105.84902723548477,-5.9437486859743212],[105.84902682258803,-5.9434792805280923],[105.84875775505868,-5.9434796938683769],[105.84848868751031,-5.9434801070776855],[105.84848910014544,-5.9437495125616389],[105.84875816782461,-5.9437490993334716],[105.84875858060958,-5.9440185047960012],[105.84902764840058,-5.9440180914179859]]],
              [[[105.84848910014544,-5.9437495125616389],[105.84822003244719,-5.9437499256588264],[105.8482196199429,-5.9434805201560197],[105.84795055235645,-5.9434809331033769],[105.84794972766655,-5.9429421220520346],[105.84768066032268,-5.9429425348307339],[105.84768148475096,-5.9434813459197589],[105.84741241712649,-5.9434817586051638],[105.84741282923835,-5.9437511641644969],[105.84714376146403,-5.9437515767377569],[105.84660562585837,-5.9437524014913299],[105.8466060375968,-5.9440218071045701],[105.84660644935418,-5.9442912127151111],[105.84660727292598,-5.9448300239282599],[105.84687634126165,-5.9448296115416923],[105.84687757715434,-5.9456378282851023],[105.84741571455375,-5.9456370030059889],[105.84741489008286,-5.9450981919216437],[105.84714582165437,-5.9450986045890533],[105.84714540957829,-5.9448291990241193],[105.84741447787592,-5.9448287863755409],[105.847414065688,-5.9445593808267532],[105.84768313383579,-5.944558968066004],[105.84768272153606,-5.9442895625334202],[105.84795178953398,-5.9442891496605137],[105.84795220196455,-5.9445585551742548],[105.84822127007429,-5.9445581421515072],[105.84822085751289,-5.9442887366566133],[105.84822044497054,-5.944019331159069],[105.84848951279957,-5.944018918043029],[105.84848910014544,-5.9437495125616389]]]
            ]
          },
          "properties": {
            "OBJECTID": 2,
            "Id": 2,
            "gridcode": 4,
            "Shape_Length": 26269.394836278632,
            "Shape_Area": 369025.43141308893,
            "luasan": 36.923963617980633
          }
        },
        {
          "type": "Feature",
          "id": 3,
          "geometry": {
            "type": "MultiPolygon",
            "coordinates": [
              [[[105.85714019817163,-5.9701378894195285],[105.85714061689686,-5.9704072940341497],[105.85767877697185,-5.9704064552912115],[105.85767835798383,-5.9701370507147011],[105.85714019817163,-5.9701378894195285]]],
              [[[105.85714019817163,-5.9701378894195285],[105.85713977946565,-5.9698684848022303],[105.85660161983935,-5.9698693229427047],[105.85660203828253,-5.9701387275980915],[105.85714019817163,-5.9701378894195285]]],
              [[[105.85767752006551,-5.969598241553614],[105.85767668222417,-5.9690594323819326],[105.85740760285329,-5.9690598517238946],[105.85740802163293,-5.969329256330159],[105.85713894211143,-5.9693296755596315],[105.85713936077892,-5.9695990801822179],[105.85767752006551,-5.969598241553614]]],
              [[[105.85282617225377,-5.9644870762059101],[105.85282742097343,-5.9652952911215449],[105.8530964988318,-5.9652948742811995],[105.85309691524127,-5.9655642792288051],[105.85336599321181,-5.9655638622380369],[105.85363507116321,-5.9655634451158059],[105.85363548785443,-5.9658328500227871],[105.8536359045648,-5.9661022549271587],[105.85363632129433,-5.9663716598288552],[105.85390539962053,-5.9663712425182345],[105.85390331550789,-5.9650242180780682],[105.85471054840181,-5.9650229656421061],[105.85471013124291,-5.9647535608030662],[105.85470971410319,-5.9644841559613173],[105.85390248199698,-5.9644854082833598],[105.85390289874286,-5.9647548131820685],[105.85309566607033,-5.9647560643780482],[105.85309524971831,-5.9644866594224339],[105.85282617225377,-5.9644870762059101]]],
              [[[105.85282617225377,-5.9644870762059101],[105.85282533986971,-5.9639482662488925],[105.8525562626486,-5.9639486828630259],[105.85255709477012,-5.9644874928579439],[105.85282617225377,-5.9644870762059101]]],
              [[[105.8608984878373,-5.9644745155249179],[105.86089764757676,-5.9639357067104983],[105.86062857093241,-5.9639361272674893],[105.86062899092175,-5.9642055316951916],[105.86035991412682,-5.9642059521398787],[105.86036033400418,-5.9644753565839794],[105.8608984878373,-5.9644745155249179]]],
              [[[105.85416947528658,-5.9631379665358573],[105.85416905852442,-5.9628685616402306],[105.85389998192412,-5.962868978835588],[105.85390039855503,-5.963138383750195],[105.85416947528658,-5.9631379665358573]]],
              [[[105.855245364734,-5.9628668915447518],[105.85524494746606,-5.962597486722415],[105.85497587107368,-5.9625979044243884],[105.85497628821041,-5.9628673092657287],[105.855245364734,-5.9628668915447518]]],
              [[[105.85578310019325,-5.9625966509242714],[105.85578268268202,-5.9623272461373551],[105.85551360645925,-5.9623276640831095],[105.85551402383926,-5.9625970688890426],[105.85578310019325,-5.9625966509242714]]],
              [[[105.85604758351744,-5.9596327802348572],[105.85604716608627,-5.9593633754376842],[105.8557780913259,-5.9593637933055881],[105.85577850862592,-5.9596331981217832],[105.85604758351744,-5.9596327802348572]]],
              [[[105.84069717504237,-5.9510354009645967],[105.84015903145951,-5.9510362204395992],[105.84015944056721,-5.9513056264310853],[105.84042851249905,-5.9513052167404812],[105.84042933103295,-5.9518440286781331],[105.84043014964232,-5.9523828406051775],[105.84123736689666,-5.9523816105222229],[105.84123654750127,-5.9518427987072986],[105.84096747536402,-5.9518432088287394],[105.84096706582565,-5.951573802898583],[105.84069799380055,-5.9515742128701739],[105.84069717504237,-5.9510354009645967]]],
              [[[105.8466179862739,-5.9518345687344905],[105.84661716171429,-5.9512957576591798],[105.846616749463,-5.9510263521175375],[105.8463476780974,-5.9510267648057766],[105.84634891451533,-5.9518349814791671],[105.8466179862739,-5.9518345687344905]]],
              [[[105.85630288897831,-5.9507420031367637],[105.85630247205005,-5.9504725982710562],[105.85603340163408,-5.9504730156423724],[105.85603381843137,-5.9507424205271073],[105.85630288897831,-5.9507420031367637]]],
              [[[105.85226558392641,-5.9499400347631903],[105.85226516902009,-5.9496706296047082],[105.85199609870953,-5.9496710449522592],[105.85199651348492,-5.9499404501296782],[105.85226558392641,-5.9499400347631903]]],
              [[[105.85441440387437,-5.9475120619549147],[105.85360719648681,-5.9475133102954194],[105.8536076118947,-5.9477827153803],[105.85414575043401,-5.9477818832464084],[105.854146997558,-5.9485900983713211],[105.8546851368062,-5.9485892655992165],[105.85468555281439,-5.9488586705975637],[105.85360927371765,-5.9488603356933485],[105.85360968922129,-5.9491297407649721],[105.85387875915515,-5.9491293246686938],[105.85387917480888,-5.9493987297187108],[105.85387959048177,-5.9496681347660418],[105.85414866065834,-5.9496677185007041],[105.85414907648133,-5.9499371235264542],[105.8538800061738,-5.9499375398107714],[105.85388042188501,-5.950206944852833],[105.85414949232349,-5.9502065285495362],[105.85414990818482,-5.9504759335699475],[105.85388083761536,-5.9504763498922237],[105.85388125336489,-5.9507457549289633],[105.85441939474656,-5.9507449221153159],[105.8544198107772,-5.9510143271114373],[105.85495795234417,-5.9510134937352559],[105.85495753605157,-5.9507440887771228],[105.85468846540866,-5.9507445055117874],[105.85468804926623,-5.950475100532004],[105.85468763314299,-5.9502056955495704],[105.85522577388576,-5.9502048620251085],[105.85522619027094,-5.9504742669695414],[105.85549526074452,-5.9504738499916145],[105.85549484422837,-5.9502044450661913],[105.8557639145518,-5.9502040279761497],[105.85576349792389,-5.9499346230670715],[105.85522535751977,-5.9499354570780048],[105.8546872170389,-5.9499362905644659],[105.8546863848883,-5.9493974805863186],[105.85495545487642,-5.949397063946642],[105.85495587107309,-5.9496664689180179],[105.85522494117298,-5.949666052128233],[105.85522452484538,-5.9493966471758597],[105.85549359479513,-5.9493962302739707],[105.85549317835577,-5.9491268253379204],[105.85522410853693,-5.9491272422208006],[105.85522285972681,-5.9483190273397133],[105.85495379028158,-5.9483194440344818],[105.85495337418084,-5.9480500390498641],[105.85468430484735,-5.9480504555945535],[105.8546838888967,-5.9477810505882349],[105.85441481967494,-5.9477814669828568],[105.85441440387437,-5.9475120619549147]]],
              [[[105.84257534498312,-5.9475302527283249],[105.84257493496125,-5.9472608468680122],[105.84230586514457,-5.9472612573269812],[105.84230627503554,-5.9475306632060159],[105.84257534498312,-5.9475302527283249]]],
              [[[105.85145050005546,-5.9448225809261954],[105.85145008590497,-5.9445531756605723],[105.85118101802401,-5.944553590255313],[105.85118143204365,-5.9448229955398553],[105.85145050005546,-5.9448225809261954]]],
              [[[105.84983485165914,-5.9440168504980138],[105.84983443835088,-5.943747445110982],[105.8495653707479,-5.9437478588630759],[105.84956578392533,-5.9440172642689912],[105.84983485165914,-5.9440168504980138]]]
            ]
          },
          "properties": {
            "OBJECTID": 3,
            "Id": 3,
            "gridcode": 6,
            "Shape_Length": 5718.5077194347978,
            "Shape_Area": 91369.277488831402,
            "luasan": 9.1422245883788325
          }
        },
        {
          "type": "Feature",
          "id": 4,
          "geometry": {
            "type": "MultiPolygon",
            "coordinates": [
              [[[105.85902291794501,-5.9695961426799089],[105.85956107696191,-5.9695953022095498],[105.85956065711189,-5.9693258977586519],[105.85902249835776,-5.9693267381908148],[105.85902291794501,-5.9695961426799089]]],
              [[[105.85902291794501,-5.9695961426799089],[105.85875383840765,-5.969596562717757],[105.85875299951522,-5.9690577536986638],[105.85848392022135,-5.9690581735667942],[105.85848350093541,-5.968788769034191],[105.85821442175366,-5.9687891887517024],[105.8582148409082,-5.969058593303382],[105.85821526008202,-5.9693279978524521],[105.85848433952654,-5.969327578096788],[105.85848517819474,-5.9698663871487403],[105.85902333755153,-5.9698655471664264],[105.85902291794501,-5.9695961426799089]]]
            ]
          },
          "properties": {
            "OBJECTID": 4,
            "Id": 4,
            "gridcode": 3,
            "Shape_Length": 7445.9735930180177,
            "Shape_Area": 64756.86656980183,
            "luasan": 6.4794396023932626
          }
        },
        {
          "type": "Feature",
          "id": 5,
          "geometry": {
            "type": "MultiPolygon",
            "coordinates": [
              [[[105.85902207878979,-5.9690573336989923],[105.85902123971168,-5.9685185247074335],[105.85875216069985,-5.9685189446689293],[105.85875299951522,-5.9690577536986638],[105.85902207878979,-5.9690573336989923]]]
            ]
          },
          "properties": {
            "OBJECTID": 5,
            "Id": 5,
            "gridcode": 1,
            "Shape_Length": 2144.440394802019,
            "Shape_Area": 17741.607279537973,
            "luasan": 1.7751922040487897
          }
        },
        {
          "type": "Feature",
          "id": 6,
          "geometry": {
            "type": "MultiPolygon",
            "coordinates": [
              [[[105.85875299951522,-5.9690577536986638],[105.85875383840765,-5.969596562717757],[105.85902291794501,-5.9695961426799089],[105.85902249835776,-5.9693267381908148],[105.85902207878979,-5.9690573336989923],[105.85875299951522,-5.9690577536986638]]],
              [[[105.85875299951522,-5.9690577536986638],[105.85875216069985,-5.9685189446689293],[105.85848308166874,-5.9685193644988939],[105.85848350093541,-5.968788769034191],[105.85848392022135,-5.9690581735667942],[105.85875299951522,-5.9690577536986638]]]
            ]
          },
          "properties": {
            "OBJECTID": 6,
            "Id": 6,
            "gridcode": 2,
            "Shape_Length": 3871.9062683386728,
            "Shape_Area": 35483.214558035754,
            "luasan": 3.5503812722311419
          }
        }
      ]
    };

    // ==================== INISIALISASI PETA ====================
    const map = L.map('map').setView([-5.969, 105.859], 14);

    // Layer Dasar
    const basemaps = {
      'osm': L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '¬© OpenStreetMap contributors'
      }),
      'satellite': L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
        attribution: '¬© Esri'
      }),
      'terrain': L.tileLayer('https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.jpg', {
        attribution: '¬© Stamen Design'
      })
    };

    let currentBasemap = 'satellite';
    basemaps[currentBasemap].addTo(map);

    // ==================== SISTEM INTEGRASI GEOJSON ====================
    let geoJSONLayer = null;
    let densityChart = null;
    let currentFilter = 'all';

    // Fungsi untuk memuat dan menampilkan data GeoJSON
    function loadGeoJSONData() {
        // Hapus layer sebelumnya jika ada
        if (geoJSONLayer) {
            map.removeLayer(geoJSONLayer);
        }
        
        const data = evisangiang20;
        
        // Hitung statistik
        calculateStatistics(data);
        
        // Style berdasarkan gridcode (kerapatan vegetasi)
        function getStyleByGridcode(feature) {
            const gridcode = feature.properties.gridcode;
            let color, opacity, weight;
            
            switch(gridcode) {
                case 1: // Sangat Rendah
                    color = '#ffffcc';
                    opacity = 0.7;
                    weight = 1;
                    break;
                case 2: // Rendah
                    color = '#c2e699';
                    opacity = 0.7;
                    weight = 1;
                    break;
                case 3: // Sedang-Rendah
                    color = '#78c679';
                    opacity = 0.7;
                    weight = 1.5;
                    break;
                case 4: // Sedang
                    color = '#31a354';
                    opacity = 0.8;
                    weight = 2;
                    break;
                case 5: // Tinggi
                    color = '#006837';
                    opacity = 0.9;
                    weight = 2.5;
                    break;
                case 6: // Sangat Tinggi
                    color = '#004529';
                    opacity = 1;
                    weight = 3;
                    break;
                default:
                    color = '#808080';
                    opacity = 0.5;
                    weight = 1;
            }
            
            return {
                fillColor: color,
                color: color,
                weight: weight,
                opacity: 0.8,
                fillOpacity: opacity
            };
        }
        
        // Filter function
        function filterByDensity(feature) {
            if (currentFilter === 'all') return true;
            return feature.properties.gridcode.toString() === currentFilter;
        }
        
        // Tambah layer GeoJSON ke peta
        geoJSONLayer = L.geoJSON(data, {
            style: getStyleByGridcode,
            filter: filterByDensity,
            onEachFeature: function(feature, layer) {
                const props = feature.properties;
                
                let popupContent = `
                    <div style="max-width: 280px;">
                        <h4 style="margin:0 0 8px 0; color: #0a5c36; border-bottom: 2px solid #0a5c36; padding-bottom: 4px;">
                            Evisangiang20 - Poligon ${props.Id}
                        </h4>
                        <div style="font-size: 12px; color: #333; line-height: 1.4;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                <strong>Kerapatan:</strong> 
                                <span style="color: ${getColorByGridcode(props.gridcode)}; font-weight: bold;">
                                    ${getKerapatanLabel(props.gridcode)}
                                </span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                <strong>Gridcode:</strong> <span>${props.gridcode || 'N/A'}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                <strong>Luasan:</strong> <span>${props.luasan ? props.luasan.toFixed(4) + ' ha' : 'N/A'}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                <strong>Shape Length:</strong> <span>${props.Shape_Length ? props.Shape_Length.toFixed(2) + ' m' : 'N/A'}</span>
                            </div>
                        </div>
                `;
                
                // Tambahkan info tambahan berdasarkan gridcode
                popupContent += `
                    <div style="margin-top: 8px; padding: 6px; background: #f8f9fa; border-radius: 4px; font-size: 11px; border-left: 3px solid ${getColorByGridcode(props.gridcode)};">
                        <strong>Indeks Vegetasi:</strong> ${getKerapatanLabel(props.gridcode)}<br>
                        <div style="width: 100%; height: 8px; background: linear-gradient(90deg, #ffffcc, #004529); margin: 4px 0; border-radius: 4px; position: relative;">
                            <div style="position: absolute; left: ${((props.gridcode - 1) / 5) * 100}%; width: 20%; height: 100%; background: ${getColorByGridcode(props.gridcode)}; border-radius: 4px;"></div>
                        </div>
                        <div style="display: flex; justify-content: space-between; font-size: 9px; color: #666;">
                            <span>Sangat Rendah</span>
                            <span>Sangat Tinggi</span>
                        </div>
                    </div>
                `;
                
                popupContent += `</div>`;
                layer.bindPopup(popupContent);
                
                // Tooltip
                layer.bindTooltip(`Evisangiang20 - ${getKerapatanLabel(props.gridcode)} (${props.luasan ? props.luasan.toFixed(4) + ' ha' : 'N/A'})`, {
                    permanent: false,
                    direction: 'auto',
                    className: 'custom-tooltip'
                });
            }
        }).addTo(map);
        
        // Fit bounds ke data
        if (geoJSONLayer.getBounds().isValid()) {
            map.fitBounds(geoJSONLayer.getBounds());
        } else {
            console.warn('Bounds tidak valid, menggunakan view default');
            map.setView([-5.969, 105.859], 14);
        }
        
        console.log(`Data Evisangiang20 berhasil dimuat - ${data.features.length} fitur`);
    }

    // Fungsi untuk mendapatkan label kerapatan
    function getKerapatanLabel(gridcode) {
        switch(gridcode) {
            case 1: return "Sangat Rendah";
            case 2: return "Rendah";
            case 3: return "Sedang-Rendah";
            case 4: return "Sedang";
            case 5: return "Tinggi";
            case 6: return "Sangat Tinggi";
            default: return "Tidak Diketahui";
        }
    }

    // Fungsi untuk menghitung statistik
    function calculateStatistics(data) {
        let totalLuasan = 0;
        let jumlahPoligon = data.features.length;
        let luasanMax = 0;
        let luasanMin = Infinity;
        let kerapatanRata = 0;
        
        const densityCount = {
            1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0
        };
        
        data.features.forEach(feature => {
            const luasan = feature.properties.luasan || 0;
            const gridcode = feature.properties.gridcode || 1;
            
            totalLuasan += luasan;
            densityCount[gridcode]++;
            
            if (luasan > luasanMax) luasanMax = luasan;
            if (luasan < luasanMin) luasanMin = luasan;
            kerapatanRata += gridcode;
        });
        
        kerapatanRata = (kerapatanRata / jumlahPoligon).toFixed(1);
        
        // Update statistik panel
        document.getElementById('totalLuas').textContent = totalLuasan.toFixed(4) + ' ha';
        document.getElementById('jumlahPoligon').textContent = jumlahPoligon;
        document.getElementById('kerapatanRata').textContent = kerapatanRata;
        document.getElementById('luasMax').textContent = luasanMax.toFixed(4) + ' ha';
        document.getElementById('luasMin').textContent = luasanMin.toFixed(4) + ' ha';
        
        // Update detail kerapatan
        document.getElementById('detailSangatRendah').textContent = densityCount[1] + ' poligon';
        document.getElementById('detailRendah').textContent = densityCount[2] + ' poligon';
        document.getElementById('detailSedangRendah').textContent = densityCount[3] + ' poligon';
        document.getElementById('detailSedang').textContent = densityCount[4] + ' poligon';
        document.getElementById('detailTinggi').textContent = densityCount[5] + ' poligon';
        document.getElementById('detailSangatTinggi').textContent = densityCount[6] + ' poligon';
        
        // Update data display
        document.getElementById('dataSangatRendah').textContent = densityCount[1] + ' poligon';
        document.getElementById('dataRendah').textContent = densityCount[2] + ' poligon';
        document.getElementById('dataSedangRendah').textContent = densityCount[3] + ' poligon';
        document.getElementById('dataSedang').textContent = densityCount[4] + ' poligon';
        document.getElementById('dataTinggi').textContent = densityCount[5] + ' poligon';
        document.getElementById('dataSangatTinggi').textContent = densityCount[6] + ' poligon';
        document.getElementById('dataEVI').textContent = kerapatanRata;
        
        // Update chart
        updateDensityChart(densityCount);
    }

    // Fungsi untuk update chart kerapatan
    function updateDensityChart(densityCount) {
        const ctx = document.getElementById('densityChart').getContext('2d');
        
        if (densityChart) {
            densityChart.destroy();
        }
        
        densityChart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: ['Sangat Rendah', 'Rendah', 'Sedang-Rendah', 'Sedang', 'Tinggi', 'Sangat Tinggi'],
                datasets: [{
                    label: 'Distribusi Kerapatan',
                    data: [
                        densityCount[1],
                        densityCount[2],
                        densityCount[3],
                        densityCount[4],
                        densityCount[5],
                        densityCount[6]
                    ],
                    backgroundColor: [
                        '#ffffcc',
                        '#c2e699',
                        '#78c679',
                        '#31a354',
                        '#006837',
                        '#004529'
                    ],
                    borderColor: [
                        '#d9d9a3',
                        '#a8c97f',
                        '#5fa85a',
                        '#298845',
                        '#005426',
                        '#003318'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            boxWidth: 12,
                            font: {
                                size: 10
                            }
                        }
                    },
                    title: {
                        display: true,
                        text: 'Distribusi Kerapatan EVI',
                        font: {
                            size: 12
                        }
                    }
                }
            }
        });
    }

    // Fungsi untuk mendapatkan warna berdasarkan gridcode
    function getColorByGridcode(gridcode) {
        switch(gridcode) {
            case 1: return '#ffffcc';
            case 2: return '#c2e699';
            case 3: return '#78c679';
            case 4: return '#31a354';
            case 5: return '#006837';
            case 6: return '#004529';
            default: return '#808080';
        }
    }

    // ==================== INISIALISASI ====================
    document.addEventListener('DOMContentLoaded', function() {
        // Load data Evisangiang20
        setTimeout(() => {
            loadGeoJSONData();
        }, 1000);
        
        // Scale update
        map.on('zoomend', function() {
            const zoom = map.getZoom();
            const scale = Math.round(591657550 / Math.pow(2, zoom - 1));
            document.getElementById('scaleBox').textContent = `Skala: 1:${scale.toLocaleString()}`;
        });
        map.fire('zoomend');
    });

  </script>

</body>
</html>